CREATE TABLE IF NOT EXISTS users (
    id INTEGER PRIMARY KEY
);

ALTER TABLE users ADD COLUMN IF NOT EXISTS username VARCHAR(50) UNIQUE NOT NULL;
ALTER TABLE users ADD COLUMN IF NOT EXISTS permissions INTEGER NOT NULL;

CREATE TABLE IF NOT EXISTS files (
    key VARCHAR(80) PRIMARY KEY
);

ALTER TABLE files ADD COLUMN IF NOT EXISTS user_id INTEGER REFERENCES users(id);
ALTER TABLE files ADD COLUMN IF NOT EXISTS name VARCHAR(255) NOT NULL;
ALTER TABLE files ADD COLUMN IF NOT EXISTS size INTEGER NOT NULL;
ALTER TABLE files ADD COLUMN IF NOT EXISTS visible INTEGER DEFAULT 0 NOT NULL;
ALTER TABLE files ADD COLUMN IF NOT EXISTS path VARCHAR(500) NOT NULL;
ALTER TABLE files ADD COLUMN IF NOT EXISTS uploaded_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP;